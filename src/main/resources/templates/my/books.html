<!doctype html>
<html lang="pl"
      xmlns:th="http://www.thymeleaf.org"
      th:replace="~{fragments/layout :: layout(
            pageTitle='Moje książki',
            content=~{::content},
            activeNav='my-books'
      )}">

<div th:fragment="content">
    <h1 class="h3 mb-3">Moje książki</h1>

    <div th:if="${success}" class="alert alert-success" th:text="${success}"></div>
    <div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>

    <h2 class="h5 mt-4">Aktywne rezerwacje</h2>
    <div th:if="${#lists.isEmpty(reservations)}" class="text-muted">Brak aktywnych rezerwacji.</div>

    <div class="table-responsive" th:if="${!#lists.isEmpty(reservations)}">
        <table class="table table-sm align-middle">
            <thead>
            <tr>
                <th>Tytuł</th>
                <th>Egzemplarz</th>
                <th>Odbiór do</th>
                <th></th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="r : ${reservations}">
                <td th:text="${r.copy.publication.title}">Tytuł</td>
                <td th:text="${r.copy.inventoryCode}">KOD</td>
                <td th:text="${#temporals.format(r.pickupUntil, 'yyyy-MM-dd HH:mm')}">2026-01-01</td>
                <td class="text-end">
                    <form th:action="@{|/my/reservations/${r.id}/cancel|}" method="post">
                        <button class="btn btn-outline-danger btn-sm" type="submit">Anuluj</button>
                    </form>
                </td>
            </tr>
            </tbody>
        </table>
    </div>

    <h2 class="h5 mt-4">Aktywne wypożyczenia</h2>
    <div th:if="${#lists.isEmpty(loans)}" class="text-muted">Brak aktywnych wypożyczeń.</div>

    <div class="table-responsive" th:if="${!#lists.isEmpty(loans)}">
        <table class="table table-sm align-middle">
            <thead>
            <tr>
                <th>Tytuł</th>
                <th>Egzemplarz</th>
                <th>Termin zwrotu</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="l : ${loans}">
                <td th:text="${l.copy.publication.title}">Tytuł</td>
                <td th:text="${l.copy.inventoryCode}">KOD</td>
                <td th:text="${l.dueDate}">2026-01-01</td>
            </tr>
            </tbody>
        </table>
    </div>
</div>

</html>
